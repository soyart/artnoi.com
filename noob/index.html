<!DOCTYPE html><html lang=en> <head><title>Artnoi.com</title><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=keywords content="artnoi, Prem Phansuriyanon"><meta name=author content=@artnoi><meta charset=UTF-8><link href=/style.css rel=stylesheet></head> <body> <ul class=navbar> <li><a href=/ ><img src=/toplogo.png alt=Artnoi.com class=logo>artnoi</a></li> <li class=f-right><a href=/cheat/ >cheat</a></li> <li class=f-right><a href=/blog/ >blog</a></li> <li class=f-right><a href=/about/ >about</a></li> </ul> <h1 id=Cheat%20sheet%20for%20n00bs>Cheat sheet for n00bs</h1> <p><a href=#others>Other cheat sheets</a> are also available</p> <h2 id=UNIX%20manual%20pages%20(%3Ccode%3Eman(1)%3C/code%3E%20pages)>UNIX manual pages (<code>man(1)</code> pages)</h2> <p>It is best to first read the manual with <code>man(1)</code>. See also: <a href=https://en.wikipedia.org/wiki/Man_page#Command_usage>usage</a>.</p> <h4 id=Arch%20Linux%20%3Ccode%3Eman(1)%3C/code%3E%20pages>Arch Linux <code>man(1)</code> pages</h4> <p>Arch Linux&#8217;s <code>base</code> metapackage by default does not ship with <code>man(1)</code>, although the package manual pages are already packaged and installed on the system by <code>pacman</code>.</p> <p>To use <code>man(1)</code>, install <code>man-db</code> packages:</p> <pre><code class=language-shell>pacman -S man-db;
man ls; # see manual pages for ls(1)
</code></pre> <h2 id=Users%20and%20groups>Users and groups</h2> <h3 id=Changing%20one&#8217;s%20own%20password>Changing one&#8217;s own password</h3> <pre><code class=language-shell>passwd &#60;USERNAME&#62;;
</code></pre> <p>You can put your own <code>username</code> or you can just omit it.</p> <h3 id=Changing%20other%20user&#8217;s%20password>Changing other user&#8217;s password</h3> <pre><code class=language-shell>passwd &#60;USERNAME&#62;;
</code></pre> <h3 id=Switching%20user%20(with%20new%20user&#8217;s%20password)>Switching user (with new user&#8217;s password)</h3> <pre><code class=language-shell>su &#60;USERNAME&#62;;
</code></pre> <p><code>su</code> defaults to root user and will ask for the root password, i.e. if <code>&#60;USERNAME&#62;</code> is not specified.</p> <h3 id=Switching%20to%20root%20using%20%3Ccode%3Esudo(8)%3C/code%3E%20(using%20%3Ccode%3Esudo%3C/code%3E%20requires%20the%20admin%20user&#8217;s%20password,%20not%20root%20password)>Switching to root using <code>sudo(8)</code> (using <code>sudo</code> requires the admin user&#8217;s password, not root password)</h3> <pre><code class=language-shell>sudo -i;
</code></pre> <h2 id=Files%20and%20permissions>Files and permissions</h2> <h3 id=Using%20%3Ccode%3Els(1)%3C/code%3E%20to%20print%20a%20&#8216;long&#8217;%20(detailed)%20output>Using <code>ls(1)</code> to print a &#8216;long&#8217; (detailed) output</h3> <pre><code class=language-shell>ls -l;
</code></pre> <h3 id=Changing%20permissions%20(or%20&#8216;modes&#8217;)%20with%20%3Ccode%3Echmod(1)%3C/code%3E>Changing permissions (or &#8216;modes&#8217;) with <code>chmod(1)</code></h3> <pre><code class=language-shell>chown &#60;OWNER&#62;:&#60;GROUP&#62; &#60;PATH&#62;;
</code></pre> <h3 id=Changing%20file%20permissions>Changing file permissions</h3> <pre><code class=language-shell>chmod &#60;MODE&#62; &#60;PATH&#62;;
</code></pre> <blockquote> <p>Hint: Use <code>-R</code> option to use <code>chmod(1)</code> or <code>chown(1)</code> recursively: <code># chown -R artnoi:artnoi &#47;home&#47;artnoi&#47;Downloads</code></p> </blockquote> <p>Note that the modes can be either</p> <ol> <li> <a href=https://www.cyberciti.biz/faq/unix-linux-bsd-chmod-numeric-permissions-notation-command>Numerical</a> which can be <a href=https://chmod-calculator.com>calculated</a> or memorized easily (e.g. <code>600</code> for private files, <code>755</code> for normal files)</li> <li> <code>drwxrwxrwx</code> = directory(<code>d</code>) + user(<code>rwx</code>) + group(<code>rwx</code>) + others(<code>rwx</code>)</li> </ol> <h3 id=Examples:%20changing%20file%20permission%20with%20%3Ccode%3Echmod(1)%3C/code%3E>Examples: changing file permission with <code>chmod(1)</code></h3> <p>Adding <em>execute</em> permission to file <code>foo</code></p> <pre><code class=language-shell>chmod +x foo;
</code></pre> <p>Removing <em>write</em> permission to file <code>foo</code></p> <pre><code class=language-shell>chmod -w foo;
</code></pre> <p>Adding <em>write</em> permission to all files in directory <code>bar</code></p> <pre><code class=language-shell>chmod -R +w bar;
</code></pre> <p>Adding <em>read and wite</em> permission to all files in directory <code>bar</code> <strong>for owner&#8217;s &#8216;group&#8217; members</strong></p> <pre><code class=language-shell>chmod -R g+rw bar;
</code></pre> <p>Removing <em>write, read, and execute</em> permission to all files in directory <code>bar</code> <strong>for &#8216;others&#8217; (world)</strong></p> <pre><code class=language-shell>chmod -R o-rwx bar;
</code></pre> <h2 id=Arch%20Linux%20package%20management>Arch Linux package management</h2> <blockquote> <p>See also: <a href=https://man.archlinux.org/man/pacman.8>manual for <code>pacman(8)</code></a></p> </blockquote> <p>Arch Linux official package manager is <code>pacman(8)</code>. The program has a few majors operations, namely <code>-S</code> (<code>--sync</code>) for syncing from the repos, <code>-Q</code> for querying the local database, <code>-R</code> (<code>--remove</code>) for removing packages, and <code>-D</code> (<code>--database</code>) for database operation.</p> <p>These major operations, when used in shortened forms, are in uppercase.</p> <h3 id=Searching%20and%20querying%20package%20info>Searching and querying package info</h3> <h4 id=Searching%20for%20packages%20using%20regexp%20(%3Ccode%3E-s%3C/code%3E,%20or%20%3Ccode%3E--search%3C/code%3E)>Searching for packages using regexp (<code>-s</code>, or <code>--search</code>)</h4> <p>Search option will use the <a href=https://en.wikipedia.org/wiki/Regular_expression>regular expression</a> to search for packages. <code>-S</code> means that <code>pacman</code> will search on the repos, while <code>-Q</code> will make it search the local database.</p> <pre><code class=language-shell>pacman -Ss tmux; # search mirrors
pacman -Qs tmux; # search local db
</code></pre> <h4 id=Getting%20package%20information%20(%3Ccode%3E-i%3C/code%3E,%20or%20%3Ccode%3E--info%3C/code%3E)>Getting package information (<code>-i</code>, or <code>--info</code>)</h4> <p>Note that <code>-i</code> option will use <strong>exact match</strong> (not regexp) to find the package information.</p> <pre><code class=language-shell>pacman -Si tmux;
pacman -Qi tmux;
</code></pre> <h4 id=Listing%20all%20files%20from%20packages>Listing all files from packages</h4> <pre><code class=language-shell>pacman -Ql tmux;
</code></pre> <h3 id=Completely%20removing%20a%20package>Completely removing a package</h3> <pre><code class=language-shell>pacman -Rns &#60;PACKAGE&#62;;
</code></pre> <h3 id=Syncing%20package%20database%20and%20upgrade>Syncing package database and upgrade</h3> <pre><code class=language-shell>pacman -Syyu;
</code></pre> <p>(Note the double &#8216;y&#8217;) This may be done after switching repos, i.e. from Thai servers to Korean ones.</p> <h3 id=Configuring%20%3Ccode%3Epacman.conf(5)%3C/code%3E>Configuring <code>pacman.conf(5)</code></h3> <p><code>pacman</code>&#8217;s main configuration file is stored in <code>&#47;etc&#47;pacman.conf</code>, with additional configuration files in <code>&#47;etc&#47;pacman.d</code> directory. One file that we may want to edit a little bit often is <code>&#47;etc&#47;pacman.d&#47;mirrorlist</code> which stores information about repo servers.</p> <h3 id=Getting%20block%20device%20information>Getting block device information</h3> <p>The commands below can be used to view block device information. <code>blkid</code> needs root privilege though.</p> <pre><code class=language-shell>lsblk &#60;DEVICE&#62;;    # Standard lsblk output
lsblk -f &#60;DEVICE&#62;; # More detailed output
blkid &#60;DEVICE&#62;;    # Equivalent to lsblk -f, but needs privilege
</code></pre> <p>Note that if you specify <code>&#60;DEVICE&#62;</code>, <code>lsblk(8)</code> and <code>blkid(8)</code> will only display information related to the specified device. In other words, omit <code>&#60;DEVICE&#62;</code> to get information from all block devices. Another note is that block devices can be both:</p> <ol> <li> Normal block devices - which can be found in <code>&#47;dev&#47;</code>, and usually in <em>sda, sdb2, vda, vdb1, mmcblk0, mmcblk0p3</em> formats</li> <li> Device mapper - which can be found in <code>&#47;dev&#47;mapper</code></li> </ol> <h3 id=Editting%20normal%20block%20device%20partitions>Editting normal block device partitions</h3> <pre><code class=language-shell>fdisk &#60;DEVICE&#62;;
cfdisk &#60;DEVICE&#62;;
</code></pre> <p>For logical volume, please see <code>lvm(8)</code> man pages.</p> <h3 id=Mounting&#47;unmounting%20filesystem>Mounting&#47;unmounting filesystem</h3> <p>Mounting is done with <code>mount(1)</code>:</p> <pre><code class=language-shell>mount &#60;DEVICE&#62; &#60;MOUNTPOINT&#62;;
</code></pre> <p>Unmounting is done with <code>umount(1)</code>, and only the source device or mountpoint is needed:</p> <pre><code class=language-shell>umount &#60;DEVICE&#62;;
umount &#60;MOUNTPOINT&#62;;
</code></pre> <h3 id=Creating%20(formatting)%20LUKS%20device>Creating (formatting) LUKS device</h3> <pre><code class=language-shell>cryptsetup luksFormat &#60;DEVICE&#62;;
</code></pre> <h3 id=Openning%20(unlocking)%20LUKS%20device>Openning (unlocking) LUKS device</h3> <pre><code class=language-shell>cryptsetup luksOpen &#60;DEVICE&#62; &#60;NAME&#62;;
cryptsetup luksOpen &#60;DEVICE&#62; &#60;NAME&#62; --key-file &#60;PATH&#62;;
</code></pre> <p>Now, your dm-crypt device should be available at <code>&#47;dev&#47;mapper&#47;&#60;NAME&#62;</code></p> <h3 id=Creating%20filesystem%20with%20mkfs(8)>Creating filesystem with mkfs(8)</h3> <p>A coresponding <code>mkfs</code>.<em>type</em> utility is used to create a filesystem on Linux.</p> <p><strong>EXT4</strong></p> <pre><code class=language-shell>mkfs.ext4 &#60;DEVICE&#62;;
</code></pre> <p><strong>EXT4 with no journal (lighter on systems)</strong></p> <pre><code class=language-shell>mkfs.ext4 -O "^has_journal" &#60;DEVICE&#62;;
</code></pre> <p><strong>FAT32 (using FAT)</strong></p> <pre><code class=language-shell>mkfs.fat -F32 &#60;DEVICE&#62;;
</code></pre> <p><strong>FAT32 (using VFAT)</strong></p> <pre><code class=language-shell>mkfs.vfat -F32 &#60;DEVICE&#62;;
</code></pre> <p>Example - Creating and mounting a LUKS-encrypted EXT4 filesystem on partition <code>&#47;dev&#47;vda3</code>:</p> <pre><code class=language-shell>cryptsetup luksFormat &#47;dev&#47;vda3;
cryptsetup luksOpen &#47;dev&#47;vda3 foo;
mkfs.ext4 &#47;dev&#47;mapper&#47;foo;
mount &#47;dev&#47;mapper&#47;foo &#47;mnt;
</code></pre> <h3 id=EXT4%20defrag%20(HDD)>EXT4 defrag (HDD)</h3> <p>Use <code>e4defrag(8)</code> to defrag an <em>EXT4 filesystem on a hard disk drive</em> on-line. Note that You need root privileges to defrag system files</p> <h3 id=Disk%20tuning>Disk tuning</h3> <h4 id=SSD%20TRIM>SSD TRIM</h4> <p><code>fstrim(8)</code> can be used to <em>trim</em> (i.e. discard) unused blocks on solid-state storage. The discard potentially has some benefits as it may prolong SSD lifespan and increases performance on disks that are almost full. Only SSDs should be trimmed.</p> <h4 id=EXT2,%20EXT3,%20EXT4%20filesystem%20setting>EXT2, EXT3, EXT4 filesystem setting</h4> <blockquote> <p>The EXT2-4 family of filesystems has been a staple in the Linux kernel for decades. Its most recent member, EXT4, is still very prevalent in desktop Linux users who usually like the fact that it made specifically for their kernels. EXT4 is stable, reliable, and well supported, although its lack of other modern features like compression, encryption, etc has led me to skip using it on my computers for some years now.</p> </blockquote> <p>Use <code>tune2fs(8)</code> to configure EXT2, EXT3, and EXT4 filesystems. For example, <code># tune2fs -O "^has_journal" &#47;dev&#47;mapper&#47;crypt-home</code> will disable journaling on a EXT4 filesystem residing on block device <code>&#47;dev&#47;mapper&#47;crypt-home</code>.</p> <h4 id=ZFS>ZFS</h4> <blockquote> <p>ZFS is the <em>last word</em> in filesystems. It was originally developed by Sun (Oracle), and is one of the most incredible filesystem in many ways. It can do <strong>Copy-on-Write</strong>, <strong>snapshots</strong>, <strong>compression</strong>, <strong>encryption</strong>, <strong>volume management (i.e. software RAID)</strong>, and many other amazing things to ensure your data is safe.</p> </blockquote> <p>Due to its incompatible license, ZFS was not included in the Linux kernel. Instead, a separate ZFS Linux kernel module is usually used to provide ZFS on Linux computers.</p> <h4 id=Using%20zfs(8)%20and%20zpool(8).>Using zfs(8) and zpool(8).</h4> <p>Use <code>zfs set</code> and <code>zpool set</code> to configure ZFS storage. Also, see <a href=/cheat/zfs/ >this cheat sheet</a>.</p> <h3 id=Btrfs>Btrfs</h3> <blockquote> <p>Btrfs is yet another featureful filesystem, featuring <strong>Copy-on-Write (CoW)</strong>, <strong>snapshots</strong>, <strong>compression</strong>, <strong>volume management</strong>, and many other features. Btfs currently has no encryption support, but we can always use Linux <code>dm-crypt</code> to enable encryption on block storage.</p> </blockquote> <p>See this <a href=/blog/2021/btrfs/ >blog post for Btrfs</a></p> <h3 id=fstab(5)>fstab(5)</h3> <p>In simplest terms, <code>fstab(5)</code> is a text file containing each <em>entry</em> of filesystem mounts in a line. Each line has 7 fields, and all 7 fields must be specified otherwise the mount fails. <a href=https://wiki.archlinux.org/index.php/Fstab>Here is what I think is a good guide</a> to (Arch) Linux <code>fstab</code>. I always recommend using UUID for <a href=https://wiki.archlinux.org/index.php/Persistent_block_device_naming>persistent block device naming</a>.</p> <blockquote> <p>For partitions that are not required to boot, adding <code>nofail</code> and <code>noauto</code> in the mount options is sometimes recommended to avoid boot failure if such partitions are not available at boot time.</p> </blockquote> <h3 id=Basic%20SQL>Basic SQL</h3> <p>Below is an SQL snippet for beginners</p> <pre><code class=language-sql>DROP TABLE orders;
DROP TABLE products;
DROP TABLE customers;

CREATE TABLE customers (
    id INT NOT NULL AUTO_INCREMENT,
    lname VARCHAR(255) NOT NULL,
    fname VARCHAR(255),
    city VARCHAR(255) DEFAULT "bkk",
    CONSTRAINT id_lname_unique UNIQUE(id, lname),
    PRIMARY KEY (id)
);

CREATE TABLE products (
    id INT NOT NULL AUTO_INCREMENT,
    pname VARCHAR(255),
    price INT NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE orders (
    id INT NOT NULL AUTO_INCREMENT,
    cust_id INT,
    prod_id INT,
    PRIMARY KEY (id),
    FOREIGN KEY (cust_id) REFERENCES customers(id),
    FOREIGN KEY (prod_id) REFERENCES products(id)
);

INSERT INTO customers (id, fname, lname, city) VALUES (1, "Artnoi", "Phan", "bkk");
INSERT INTO customers (id, fname, lname) VALUES (2, "Prem", "Phan");
INSERT INTO customers (fname, lname) VALUES ("Palita", "Phan");
INSERT INTO products (pname, price) VALUES ("ThinkPad", 30000);
INSERT INTO products (pname, price) VALUES ("ThinkCentre", 20000);
INSERT INTO products (pname, price) VALUES ("ThinkStaion", 40000);
INSERT INTO orders (id, cust_id, prod_id) VALUES (1, 1, 1);
INSERT INTO orders (cust_id, prod_id) VALUES (1, 2);
INSERT INTO orders (cust_id, prod_id) VALUES (1, 3);
INSERT INTO orders (cust_id, prod_id) VALUES (2, 2);

# Most expensive product
SELECT P.pname FROM products P where P.price = (SELECT max(price) FROM products);

# All customers who have ordered something
SELECT O.id AS order_id, C.id, fname, P.pname, P.price FROM customers C RIGHT JOIN orders O on C.id = O.cust_id LEFT JOIN products P ON O.prod_id = P.id;

# All customers who have bought ALL 3 products
SELECT C.id AS Cust_ID, C.fname AS Cust_name, sum(P.price) AS Total FROM customers C, products P
WHERE C.id IN
(SELECT DISTINCT C.id FROM customers C RIGHT JOIN orders O on C.id = O.cust_id LEFT JOIN products P ON O.prod_id = P.id WHERE P.id = 1)
AND C.id IN
(SELECT DISTINCT C.id FROM customers C RIGHT JOIN orders O on C.id = O.cust_id LEFT JOIN products P ON O.prod_id = P.id WHERE P.id = 2)
AND C.id IN
(SELECT DISTINCT C.id FROM customers C RIGHT JOIN orders O on C.id = O.cust_id LEFT JOIN products P ON O.prod_id = P.id WHERE P.id = 3);
</code></pre> <h2 id="%3Ca%20name=%22others%22%3E%3C/a%3E"><a name=others></a></h2> <p><a href=/cheat/arch/ >Arch Linux cheat sheet</a><br> <a href=/blog/2019/zfsarch.html>Arch Linux ZFS root</a><br> <a href=/cheat/zfs/ >ZFS cheat sheet</a><br> <a href=/cheat/device-mapper/ >Device Mapper - LUKS and LVM</a><br> <a href=/cheat/git/ >Git cheat sheet</a></p> <p><a href=/noob/block/ >Storage (disks, etc.)</a><br> <a href=/noob/boot/ >Booting the computer</a><br> <a href=/noob/desktop/ >Minimal UNIX desktop</a><br> <a href=/noob/vim/ >Vim for noobs</a></p> <hr> <p><a href=#top>Back to top</a></p> <hr> <footer> <p>Copyright (c) 2019 - 2023 Prem Phansuriyanon</p> <p>Verbatim copying and redistribution of this entire page are permitted provided this notice is preserved</p> </footer> </body> </html> 